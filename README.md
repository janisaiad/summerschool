# SciML - Scientific Machine Learning

<div align="center">
  
![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.9%2B-blue)
![TensorFlow](https://img.shields.io/badge/TensorFlow-2.8%2B-orange)

</div>

## 📝 Description

This project implements modern neural network architectures for operator modeling and solving partial differential equations (PDEs). It is developed in collaboration with Professors Hadrien Montanelli and Samuel Kokh.

## 🎯 Objectives

- Implement and compare two deep learning architectures for operator modeling:
  - **DeepONet** (Deep Operator Network) - To learn operators between function spaces
  - **FNO** (Fourier Neural Operator) - To leverage spectral analysis in operator modeling

- Apply these architectures to solving partial differential equations (PDEs), with a particular focus on the heat equation

## 🧠 Key Concepts

- **Operator Modeling**: Learning to map functional input spaces to functional output spaces
- **Spectral Analysis**: Using Fourier transforms to efficiently capture spatial dynamics
- **Supervised Learning**: Training on input-output pairs generated by classical numerical solvers

## 📊 Data Format

Training data is structured in triplets (mu, x, sol) where:
- `mu` represents input functions (e.g., boundary conditions, initial conditions)
- `x` represents points in the spatial domain
- `sol` represents expected solutions at points `x`

## �� Project Structure

```
sciml/
├── data/              # Training data and generation scripts
├── model/             # Architecture implementations
│   ├── deeponet/      # DeepONet implementation
│   └── fno/           # Fourier Neural Operator implementation
├── notebooks/         # Jupyter notebooks for experiments and visualizations
│   ├── deeponet/      # DeepONet notebooks
│   └── fno/          # FNO notebooks
├── utils/             # Utility functions
├── tests/             # Unit and integration tests
└── logs/              # Training logs and results
```

## 🚀 Installation and Setup

### Prerequisites

- Python 3.9+
- TensorFlow 2.8+
- Virtual environment (recommended)

### Installation Steps

1. Clone the repository
   ```bash
   git clone https://github.com/janisaiad/sciml.git
   cd sciml
   ```

2. Set up the environment and install dependencies
   ```bash
   chmod +x launch.sh
   ./launch.sh
   ```

3. Activate the virtual environment
   ```bash
   source .venv/bin/activate  # For Linux/MacOS
   # or
   .\.venv\Scripts\activate   # For Windows
   ```

## 📚 Usage

### Data Generation for the summer school

The project includes pre-generated benchmark datasets for training and testing. The data is organized as follows:
Download from the drive and copy to the `data/benchmarks/given/` directory. It should be in the following format:
```
data/
├── benchmarks/
│   ├── given/
│   │   ├── f_test_data.npy
│   │   ├── f_train_data.npy
│   │   ├── u_test_data_c0.2.npy
│   │   ├── u_test_data_c0.5.npy
│   │   ├── u_test_data_c1.0.npy
│   │   ├── u_train_data_c0.2.npy
│   │   ├── u_train_data_c0.5.npy
│   │   ├── u_train_data_c1.0.npy
│   │   ├── view_ref_soln.ipynb
│   │   ├── view_ref_soln.py
│   │   ├── x.npy


### Training Models

```python
from sciml.model.fno import FNO
from sciml.model.deeponet import DeepONet

# Configure and train FNO
fno_model = FNO(hyper_params, regular_params, fourier_params)
fno_model.fit()

# Configure and train DeepONet
deeponet_model = DeepONet(hyper_params, regular_params)
deeponet_model.fit()
```

### Example Notebooks

Several notebooks are available to demonstrate model usage:

- For DeepONet: `notebooks/deeponet/TORUNDEEPONETCOMPARISON.ipynb`
- For FNO: `notebooks/fno/TORUNFNO.ipynb`

### Converting Notebooks with Jupytext

To convert all notebooks to Python files:

```bash
find . -name "*.ipynb" -type f -exec jupytext --to py {} \;
```

## 🔍 Troubleshooting

If you encounter issues with JAX/JAXlib during FNO model training, try the following commands:

```bash
# Activate virtual environment if not already done
source .venv/bin/activate

# Uninstall current versions
uv pip uninstall jax jaxlib

# Install compatible versions
uv add jax
uv add jaxlib==0.4.17
```


## 📝 Research Notes and Observations

### optimization 

lr scheduling done better
The equation is local, so we should test the local one shot learning ! in a setup where we want to solve the inverse problem also
and we generate our dataset using this pinn-deeponet
be careful with data augmentation, because it's useful for foundation model but for local models it's not useful

code with dv dp is a bit broken but still need to be refined after

the main idea to put the emphasis on is that empirically the supervised learning setup is
hard to enforce the boundary condition because it has to be learnt on every basis I guess
maybe we can try to enforce it by a last layer at the end, so we have to resolve it, try and if it 
does not work (see the litterature before) there should be something under the hood
but the other thing is that the 1 shot learning can be useful also

fno and pinn fno to try
deepxde baseline to try also
we are also under the sobolev training setup, so there is the theory behind to disentangle

transfer learning maybe since it do not converge for 0.5, with a new loss then
### FNO Performance
- Too many Fourier layers destabilize training
- Consider sequential temporal inference
- Test on other data (naca)

### DeepONet Improvements
- Compare with RB and POD
- Test alternative branch/trunk architectures

### Spectral Analysis
- Impact of Fourier layer count on generalization
- Compare Fourier weights between layers
- Verify cast/coeff and phase multiplication

## 📄 License

This project is distributed under the MIT license. See the [LICENSE](LICENSE) file for more details.
